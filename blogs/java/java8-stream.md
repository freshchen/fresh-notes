# Java8新特性之Stream



集合是Java中使用最多的API,。比如，以下SQL查询语句就可以选出热量较低的菜肴名
称：SELECT name FROM dishes WHERE calorie < 400。你看，你不需要实现如何
根据菜肴的属性进行筛选（比如利用迭代器和累加器），你只需要表达你想要什么,要是要处理大量元素又该怎么办呢？为了提高性能，你需要并行处理，并利用多核架构。
但写并行代码比用迭代器还要复杂，而且调试起来也够受的！



流是Java API的新成员，它允许你以声明性方式处理数据集合（通过查询语句来表达，而不
是临时编写一个实现）。就现在来说，你可以把它们看成遍历数据集的高级迭代器。此外，流还可以透明地并行处理，你无需写任何多线程代码了







69页例子



















**在 JVM 的后台，使用通用的 fork/join 池来完成上述功能，该池是所有并行流共享的。默认情况，fork/join 池会为每个处理器分配一个线程。假设你有一台16核的机器，这样你就只能创建16个线程。对 CPU 密集型的任务来说，这样是有意义的，因为你的机器确实只能执行16个线程。但是真实情况下，不是所有的任务都是 CPU 密集型的，这就会导致线程因IO等待浪费CPU资源，降低系统处理性能。 这就解释了上面128个业务线程中只有2个线程处于RUNNABLE状态，而其他126个业务线程都在等待的原因。->因为业务线程内部使用了parallelStream处理业务数据，所以所有业务线程内部都需要使用jvm for/join线程进行业务处理，因为只有jvm fork/join线程，所以同时只能处理两个业务线程的执行逻辑**